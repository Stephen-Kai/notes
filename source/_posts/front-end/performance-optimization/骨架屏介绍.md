---
title: 骨架屏介绍
tag: 性能优化
catogory:
  - front-end
  - 性能优化
  - 骨架屏
  - 骨架屏介绍
---

# 骨架屏

## 骨架屏是什么?

> 骨架屏就是在页面数据尚未加载前，先给用户展示出页面的大致结构(灰色占位), 直到请求数据返回后再渲染页面。

## 骨架屏的好处

1: 骨架屏能在加载前把网页的大概轮廓预先展示, 降低用户等待的焦灼情绪
2: 能使界面加载过程变得自然通畅，不会造成网页长时间白屏或者闪烁
3: 提升用户体验

## 适用场景

1: 网络较慢，需要长时间等待加载处理的情况下
2: 布局排版固定的内容区域, 比如列表、文章、个人信息

## 技术方案

1: 设计师出骨架屏图片
2: 通过 HTML+CSS 编写骨架屏代码
3: 非侵入业务式手写代码
4: 非侵入式自动生成骨架屏代码

### 方案优缺点

#### 设计师出骨架屏图片

优点:

- 简单暴力

缺点:

- 变更成本和续维护成本高，且对业务代码有一定侵入性

#### 通过 HTML+CSS 编写骨架屏代码

可参考: [antD - Skeleton](https://ant.design/components/skeleton-cn/)

优点:

- 骨架屏结构可控
- 控制页面结构的粒度更小，可以到组件或者元素级别

缺点:

- 变更成本和续维护成本高，且对业务代码有一定侵入性

#### 非侵入业务式手写代码

可参考: [Vue 页面骨架屏注入实践](https://segmentfault.com/a/1190000014832185)

优点:

- 通过 webpack 注入的方式注入到项目源码中, 使骨架屏代码和业务代码解耦，后续维护成本降低

缺点:

- 依然需要手写骨架屏代码, 变更成本高
- webpack 有一定的配置成本

#### 非侵入式自动生成骨架屏代码

可参考:
[puppeteer - Chrome](https://github.com/puppeteer/puppeteer)
[一种自动化生成骨架屏的方案 - 饿了么](https://github.com/ElemeFE/page-skeleton-webpack-plugin)

优点:

- 无需手写骨架屏代码，骨架屏代码自动生成且自动注入到项目源码中
- 使用成本低

缺点:

- 暂时这种方案相对好一些

## 设计原则

- 骨架屏自动生成
- 使用和维护成本低
- 配置灵活
- 还原度高
- 尽量不影响加载性能

## 方案设计

- 骨架屏由 puppeteer 自动获取生成
- 方案以 npm 包的方式落地，支持命令行、node 调用两种使用方式
- 多种参数配置，可灵活配置页面地址、页面名称、viewport、输出路径、注入路径等
- 基于真实页面做骨架处理后，获取页面截屏或源码，保证还原度
- 采用 base64 图片作为骨架屏的默认输出形式，注入作为页面背景图片，体积小至几 K，不增加额外网络请求，避免对加载性能造成影响

## 参考文章:

[一个前端非侵入式骨架屏自动生成方案](https://korbinzhao.github.io/%E5%89%8D%E7%AB%AF%E5%BC%80%E5%8F%91/%E9%AA%A8%E6%9E%B6%E5%B1%8F/2018/06/23/skeleton-auto-generator/)
